from django_bootstrap import bootstrap
bootstrap()

import sys
import csv

from django.contrib.auth.models import User
from appl.models import Faculty, AdmissionRound
from backoffice.models import AdjustmentMajor, AdjustmentMajorSlot

NUMS = """
00219111613
00219121681
00219121691
00219121701
00219121711
00219121721
00219121722
00219131731
00219131732
00219131741
00219131742
00219141751
00219141761
00219141771
00219141781
00219151791
00219322941
00219312931
00219161811
00219161821
00219161831
00219161841
00219181861
00219181871
00219181881
00219181891
00219181901
00219181911
00219181921
00219181862
00219181872
00219181892
00219191931
00219191941
00219191951
00219191961
00219191971
00219201981
00219201982
00219201991
00219202001
00219202011
00219202021
00219202031
00219202041
00219202042
00219202051
00219202061
00219202062
00219202071
00219202081
00219202082
00219202151
00219202152
00219202161
00219202231
00219202361
00219202351
00219202301
00219201992
00219202012
00219212431
00219212432
00219171851
00219222441
00219222442
00219232451
00219232461
00219232481
00219242491
00219242501
00219242511
00219242521
00219242531
00219242541
00219242551
00219242512
00219242492
00219242522
00219242502
00219242532
00219242542
00219242552
00219252561
00219252571
00219252581
00219252591
00219252601
00219252611
00219252582
00219252592
00219262631
00219262641
00219262651
00219262621
00219262661
00219262672
00219272681
00219272691
00219272701
00219272711
00219272721
00219272731
00219282761
00219282771
00219282741
00219282751
00219282781
00219282791
00219282801
00219282811
00219292831
00219292841
00219292851
00219292861
00219292871
00219292881
00219292891
00219292901
00219302911
00219302921
00219010541
00220331801
00220010011
00220010021
00220010031
00220010041
00220010071
00220010051
00220010061
00220010043
00220020081
00220030141
00220030161
00220040171
00220040181
00220040191
00220040201
00220040202
00220040211
00220040221
00220040231
00220040241
00220040251
00220040261
00220040281
00220040291
00220040301
00220040311
00220040271
00220040272
00220040323
00220040333
00220050571
00220050361
00220050371
00220050381
00220050391
00220050401
00220050411
00220050421
00220050431
00220050441
00220050451
00220050481
00220050362
00220050372
00220050392
00220050412
00220050422
00220050452
00220050472
00220050492
00220050363
00220050423
00220050463
00220050503
00220050525
00220050535
00220050395
00220050445
00220060581
00220060591
00220060601
00220060611
00220060621
00220070641
00220070642
00220070651
00220070652
00220070661
00220070662
00220070691
00220070692
00220080701
00220080702
00220080751
00220080731
00220080741
00220080721
00220080752
00220080732
00220080742
00220080722
00220080981
00220080781
00220080791
00220080801
00220080811
00220080821
00220080831
00220080782
00220080792
00220080802
00220080812
00220080822
00220080832
00220080921
00220080931
00220080941
00220080951
00220080961
00220080971
00220080922
00220080932
00220080942
00220080952
00220080962
00220080972
00220080851
00220080861
00220080871
00220080881
00220080891
00220080901
00220080852
00220080862
00220080872
00220080882
00220080892
00220080902
00220081001
00220081011
00220081021
00220081031
00220081041
00220081002
00220081012
00220081022
00220081032
00220081042
00220081081
00220081091
00220081101
00220081111
00220081121
00220081131
00220081141
00220081151
00220081261
00220081271
00220081281
00220081291
00220081301
00220081311
00220081262
00220081272
00220081282
00220081292
00220081302
00220081312
00220080982
00220081172
00220081182
00220081192
00220081202
00220081212
00220081222
00220081232
00220081242
00220091331
00220101351
00220101361
00220101371
00220101381
00220101391
00220101372
00220101382
00220101392
00220101403
00220111411
00220111421
00220111422
00220111431
00220111441
00220111451
00220111461
00220111471
00220111481
00220111591
00220111631
00220111641
00220111651
00220111661
00220111671
00220111511
00220111521
00220111531
00220111541
00220111551
00220111561
00220111571
00220111581
00220111622
00220111613
"""

#########################################################33
#########################################################33
#########################################################33
NUMS35 = """
00236010031
00236010051
00236010021
00236010011
00236010071
00236010041
00236010061
00236040171
00236040181
00236040221
00236040261
00236040241
00236040231
00236040211
00236040301
00236040311
00236040271
00236040291
00236040281
00236040201
00236040191
00236040251
00236040323
00236040333
00236050431
00236050401
00236050361
00236050371
00236050421
00236050381
00236050481
00236050451
00236050391
00236050441
00236050362
00236050372
00236050422
00236050452
00236050363
00236050463
00236050423
00236050503
00236050445
00236050375
00236050395
00236161841
00236161811
00236161831
00236161821
00201331801
00201010011
00201010021
00201010031
00201010041
00201010071
00201010051
00201010061
00201040171
00201040181
00201040191
00201040201
00201040211
00201040221
00201040231
00201040241
00201040251
00201040261
00201040271
00201040272
00201040281
00201040291
00201040301
00201040311
00201050362
00201050372
00201050392
00201050412
00201050422
00201050452
00201050472
00201050492
00201070641
00201070651
00201070661
00201070691
00201080701
00201080702
00201080731
00201080741
00201080721
00201080751
00201080742
00201080771
00201080841
00201080911
00201081251
00201080772
00201080842
00201080912
00201081252
00201080992
00201101351
00201101361
00201101381
00201101391
00201101371
00201101403
00201111431
00201111441
00201111481
00201111491
00201111501
00201111591
00201111613
00201111631
00201131731
00201131741
00201131742
00201141751
00201141771
00201141781
00201151791
00201322941
00201312931
00203010043
00203040323
00203040333
00203050363
00203050423
00203050463
00203050503
00203050525
00203050535
00203050395
00203050445
00203070673
00203070645
00203101403
00203111613
00203121713
00202331801
00202010011
00202010021
00202010031
00202010041
00202010051
00202010071
00202020081
00202030141
00202030161
00202040171
00202040181
00202040191
00202040201
00202040211
00202040221
00202040231
00202040241
00202040251
00202040261
00202040271
00202040281
00202040291
00202040301
00202040311
00202040323
00202040333
00202050354
00202091331
00202101351
00202101361
00202101371
00202101381
00202101391
00202101403
00202131731
00202131741
00202151791
00202161821
00202171851
00202252571
00202252611
00202262631
00202262641
00202262651
00202262621
00202262661
00202262672
00202272681
00202272691
00202272701
00202272711
00202272721
00202272731
00204331801
00204010011
00204010021
00204010031
00204010041
00204010051
00204020091
00204030141
00204040191
00204040251
00204040271
00204050561
00204070641
00204070661
00204070691
00204080701
00204080702
00204080751
00204080721
00204080761
00204080991
00204081251
00204091331
00204101341
00204111411
00204121681
00204121691
00204121701
00204121711
00204131731
00204131741
00204141751
00204141761
00204141771
00204141781
00204151791
00204161841
00204181891
00204191931
00204202081
00204202082
00204212431
00204212432
00204222441
00204232461
00204232471
00204242491
00204242501
00204242511
00204242521
00204242531
00204242541
00204242551
00204252581
00204252582
00204252591
00204252592
00204252611
00204262621
00204262631
00204262641
00204262651
00204262661
00204272681
00204272691
00204272711
00204272721
00204272731
00204282741
00204282751
00204282761
00204282771
00204282781
00204282791
00204292831
00204292841
00204292851
00204292861
00204292871
00204292881
00204292891
00204292901
00217242491
00217242501
00217242511
00217242521
00217242531
00217242541
00217242551
00217242492
00217242502
00217242512
00217242522
00217242532
00217242542
00217242552
00217252561
00217252571
00217252581
00217252591
00217252601
00217252611
00217252582
00217252592
00217262631
00217262651
00217262672
00214222441
00214232451
00214232461
00214232471
00214232481
00214242491
00214242501
00214242511
00214242521
00214242531
00214242541
00214242551
00214242492
00214242502
00214242512
00214242522
00214242532
00214242542
00214242552
00214252561
00214252571
00214252581
00214252611
00214252591
00214252601
00214252582
00214252592
00214262621
00214262631
00214262641
00214262651
00214262661
00214262672
00213222441
00213232451
00213232461
00213232471
00213232481
00213242491
00213242501
00213242511
00213242521
00213242531
00213242541
00213242551
00213252561
00213252571
00213252581
00213252611
00213252591
00213252601
00213252582
00213252592
00213262621
00213262631
00213262641
00213262651
00213262661
00213262672
00215232451
00215232461
00215232471
00215232481
00211331801
00211010011
00211010021
00211010031
00211010041
00211010051
00211020081
00211030141
00211040181
00211040191
00211040211
00211040231
00211040241
00211040251
00211040261
00211040271
00211040301
00211040311
00211050561
00211060581
00211070641
00211070651
00211070661
00211070691
00211080701
00211080751
00211080721
00211080771
00211080911
00211080841
00211081251
00211080752
00211080702
00211091331
00211101351
00211101361
00211101371
00211101381
00211101391
00211111411
00211111591
00211121681
00211121691
00211121701
00211121711
00211121721
00211131731
00211131741
00211141751
00211141761
00211141771
00211141781
00211151791
00211312931
00226030141
00226030161
00226030151
00212331801
00212010051
00212010021
00212010011
00212010031
00212010041
00212020081
00212030141
00212040191
00212040231
00212040211
00212040241
00212040251
00212040261
00212040333
00212040181
00212050354
00212060581
00212060591
00212060601
00212070641
00212070691
00212070661
00212081071
00212081251
00212080771
00212080911
00212080841
00212080751
00212080741
00212080721
00212080752
00212080742
00212091331
00212101361
00212101371
00212101381
00212101403
00212111411
00212111591
00212121691
00212121701
00212121711
00212121721
00212131731
00212131741
00212141751
00212141761
00212141771
00212141781
00212151791
00208331801
00208040181
00208040191
00208040201
00208040211
00208040221
00208040231
00208040241
00208040251
00208040261
00208040323
00208040333
00208060581
00208080701
00208080702
00208080731
00208080751
00208080741
00208080721
00208080732
00208080752
00208080742
00208101351
00208101361
00208101371
00208101381
00208101391
00208101382
00208101392
00208101403
00208111613
00208121681
00208121711
00208151791
00208312931
00208060601
00209331801
00209040191
00209040211
00209040231
00209040241
00209040251
00209040261
00209040323
00209040333
00209050463
00209050525
00209050535
00209050445
00209050503
00209101351
00209101361
00209101371
00209101381
00209101391
00209101382
00209101392
00209101403
00209111613
00209121691
00209121701
00209121711
00209121721
00209121722
00206331801
00206010011
00206010021
00206010031
00206010041
00206010051
00206010061
00206010071
00206020081
00206040181
00206040191
00206040201
00206040211
00206040221
00206040231
00206040241
00206040251
00206040261
00206040323
00206040333
00206070651
00206070661
00206070691
00206080701
00206080702
00206080751
00206080741
00206080721
00206080752
00206080742
00206101351
00206101361
00206101371
00206101372
00206101381
00206101382
00206101391
00206101392
00206101403
00206111411
00206111613
00206111631
00206121681
00206121711
00206141781
00206151791
00206322941
00206312931
00225020081
00205331801
00205010011
00205010021
00205010031
00205010041
00205010051
00205010061
00205010071
00205020081
00205030141
00205040171
00205040181
00205040191
00205040201
00205040211
00205040221
00205040231
00205040241
00205040251
00205040261
00205040271
00205040281
00205040301
00205040311
00205040333
00205050361
00205050371
00205050381
00205050391
00205050401
00205050411
00205050421
00205050431
00205050441
00205050451
00205050481
00205050362
00205050372
00205050392
00205050412
00205050422
00205050452
00205050472
00205050492
00205050363
00205050423
00205050463
00205050375
00205050395
00205050445
00205050503
00205060581
00205070641
00205070651
00205070661
00205070691
00205070642
00205070673
00205080701
00205080702
00205080751
00205080731
00205080741
00205080721
00205080752
00205080742
00205080771
00205080911
00205080841
00205080772
00205080912
00205080842
00205080981
00205080991
00205080992
00205081071
00205081251
00205081252
00205091331
00205101351
00205101361
00205101371
00205101381
00205101382
00205101391
00205101403
00205111411
00205111421
00205111422
00205111431
00205111451
00205111511
00205111591
00205111631
00205111622
00205111613
00205121681
00205121691
00205121701
00205121711
00205121721
00205121722
00205131731
00205131741
00205141751
00205141761
00205141771
00205141781
00205151791
00205161811
00205161821
00205161831
00205161841
00205181861
00205181871
00205181881
00205181891
00205181901
00205181911
00205181921
00205191931
00205191941
00205191951
00205191961
00205191971
00205212431
00205212432
00205222441
00205232451
00205232471
00205242491
00205242501
00205242511
00205242521
00205242531
00205242541
00205242551
00205242492
00205242502
00205242512
00205242522
00205242532
00205242542
00205242552
00205252581
00205252591
00205252601
00205252611
00205252582
00205252592
00205262621
00205262631
00205262641
00205262651
00205262661
00205272681
00205272691
00205272701
00205272711
00205272721
00205272731
00205282781
00205282801
00205282811
00205292831
00205292841
00205292851
00205292861
00205292871
00205292881
00205292891
00205292901
00205322941
00210331801
00210010011
00210010021
00210010031
00210010041
00210010051
00210010061
00210010071
00210020081
00210030141
00210040171
00210040181
00210040191
00210040201
00210040211
00210040221
00210040231
00210040241
00210040251
00210040261
00210040271
00210040281
00210040291
00210040301
00210040311
00210040333
00210050361
00210050371
00210050381
00210050391
00210050401
00210050411
00210050421
00210050431
00210050441
00210050451
00210050481
00210060581
00210060611
00210060621
00210070641
00210070651
00210070661
00210070691
00210070662
00210070692
00210080701
00210080702
00210080731
00210080751
00210080741
00210080721
00210080752
00210080742
00210080771
00210080911
00210080841
00210080772
00210080912
00210080842
00210080981
00210080991
00210080992
00210081071
00210081251
00210081252
00210101351
00210101361
00210101371
00210101381
00210101382
00210101391
00210101392
00210101403
00210111411
00210111421
00210111431
00210111441
00210111461
00210111511
00210111591
00210111613
00210111622
00210111631
00210121681
00210121691
00210121701
00210121711
00210121721
00210131731
00210131741
00210131742
00210141751
00210141761
00210141771
00210141781
00210151791
00210312931
00210322941
00210060601
00221322941
00216222441
00216222442
00216232451
00216232461
00216232471
00216232481
00216242491
00216242501
00216242511
00216242521
00216242531
00216242541
00216242551
00216242492
00216242502
00216242512
00216242522
00216242532
00216242542
00216242552
00216252561
00216252571
00216252581
00216252611
00216252591
00216252601
00216252582
00216252592
00216262621
00216262631
00216262641
00216262651
00216262661
00216262672
00207331801
00207040171
00207040181
00207040191
00207040201
00207040211
00207040221
00207040231
00207040241
00207040251
00207040261
00207040281
00207040291
00207040301
00207040311
00207040333
00207050362
00207050372
00207050392
00207050412
00207050422
00207050452
00207050472
00207080701
00207080702
00207080731
00207080751
00207080741
00207080721
00207080752
00207080742
00207111471
00207111431
00207111441
00207111461
00207111491
00207111501
00207111591
00207111622
00207111631
00207121711
00207141781
00207151791
00238161841
00238161811
00238161821
00238161831
00238181861
00238181891
00238181871
00238181881
00238181901
00238181921
00238181911
00238181892
00238181872
00238181862
00238191931
00238191961
00238191941
00238191951
00238191971
00238212431
00238212432
00238201991
00238202001
00238202021
00238202031
00238202051
00238202011
00238202071
00238201981
00238202061
00238202081
00238202361
00238202231
00238202351
00238202301
00238201992
00238202012
00238201982
00238202082
00238202062
00238171851
00237091331
00237161841
00237161811
00237161821
00237161831
00237181861
00237181891
00237181871
00237181881
00237181901
00237181921
00237181911
00237181892
00237181872
00237181862
00237191931
00237191961
00237191941
00237191951
00237191971
00237212431
00237212432
00237201991
00237202001
00237202021
00237202031
00237202051
00237202011
00237202071
00237201981
00237202081
00237202161
00237202361
00237202231
00237202351
00237202301
00237201992
00237202012
00237201982
00237202082
00237171851
00217272681
00217272691
00217272701
00217272711
00217272721
00217272731
00217282741
00217282751
00217282761
00217282771
00217282781
00217282791
00217282801
00217282811
00217292831
00217292841
00217292851
00217292861
00217292871
00217292881
00217292891
00217292901
00217302911
00217302921
00218272691
00218272711
00218272681
00218272701
00218272721
00218272731
00218282741
00218282751
00218282761
00218282771
00218282781
00218282791
00218282801
00218282811
00218292831
00218292841
00218292851
00218292861
00218292871
00218292881
00218292891
00218292901
00218302911
00218302921
00228040511
00233331801
00233010051
00233010021
00233010011
00233010071
00233010031
00233010041
00233010061
00233010043
00233020081
00233171851
00233040171
00233040181
00233040191
00233040201
00233040202
00233040211
00233040221
00233040231
00233040241
00233040251
00233040261
00233040271
00233040272
00233040281
00233040291
00233040301
00233040311
00233040323
00233040333
00233050422
00233050452
00233050472
00233050363
00233050423
00233050463
00233050525
00233050535
00233050395
00233050445
00233050503
00233060581
00233060591
00233060601
00233060621
00233070662
00233070692
00233070673
00233080982
00233080701
00233080702
00233080771
00233080911
00233080841
00233081251
00233081252
00233081162
00233080752
00233080762
00233101372
00233101392
00233101403
00233111421
00233111422
00233111431
00233111441
00233111451
00233111461
00233111471
00233111481
00233111511
00233111491
00233111501
00233111591
00233111613
00233111622
00233121681
00233121691
00233121701
00233121711
00233121713
00233131731
00233131732
00233131741
00233131742
00233312931
00233161841
00233161811
00233161821
00233161831
00233181861
00233181891
00233181871
00233181911
00233181892
00233181862
00233191931
00233191961
00233191941
00233191971
00233212431
00233202001
00233202021
00233202031
00233202051
00233202011
00233202071
00233201981
00233202041
00233202061
00233202081
00233202151
00233202361
00233202231
00233202351
00233202301
00233201992
00233202012
00233202152
00233201982
00233202042
00233202082
00233202062
00233242492
00233242502
00233242512
00233242522
00233242532
00233242552
00233252582
00233252592
00233262631
00233262641
00233262651
00233262621
00233262661
00233262672
00217272681
00217272691
00217272701
00217272711
00217272721
00217272731
00217282741
00217282781
00217282791
00217292831
00217292841
00217292851
00217292861
00217292871
00217292881
00217292891
00217292901
00217302911
00217302921
00224272681
00224272711
00224272721
00224272731
00224282741
00224282751
00224282761
00224282781
00224282791
00224282801
00224292831
00224292861
00224292891
00233010541
"""

def print_slot(slot):
    r = slot.admission_round_number

    faculty = slot.faculty
    prefix = ['วิทยาเขต' + faculty.campus.title + ' ' + faculty.title,
              '"' + slot.adjustment_major.title + '"',
              slot.cupt_code]
    data = [str(slot.original_slots), str(slot.current_slots)]
    if slot.original_slots != slot.current_slots:
        data.append("*")
    else:
        data.append("")
    row = prefix + [''] * ((r-2)*3) + data
    print(','.join(row))


def main():
    for num in NUMS35.split():
        num = num.strip()
        if num == '':
            continue

        slots = AdjustmentMajorSlot.objects.filter(cupt_code=num).all()
        if len(slots)==0:
            print('ERROR:', num)
            continue

        slot = slots[0]
        print_slot(slot)

    """
    rounds = [2,3,4,5]

    for r in rounds:
        slots = AdjustmentMajorSlot.objects.filter(admission_round_number=r).order_by('cupt_code').all()
        for slot in slots:
            print_slot(slot)
    """
    
if __name__ == '__main__':
    main()
    
